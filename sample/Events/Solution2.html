<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Solution using consequence</title>
    <script src="../../node_modules/wTools/staging/abase/wTools.s"></script>
    <script src="../../node_modules/wTools/staging/abase/akernel/aKernel.s"></script>
    <script src="../../node_modules/wTools/staging/abase/akernel/aKernelWithComponents.s"></script>
    <script src="../../node_modules/wTools/staging/abase/akernel/cFieldFilter.s"></script>
    <script src="../../node_modules/wTools/staging/abase/akernel/cFieldMapper.s"></script>
    <script src="../../node_modules/wTools/staging/abase/akernel/eNameTools.s"></script>
    <script src="../../node_modules/wTools/staging/abase/akernel/eExecTools.s"></script>
    <script src="../../node_modules/wTools/staging/abase/akernel/eStringTools.s"></script>
    <script src="../../node_modules/wTools/staging/abase/akernel/eInclude.s"></script>
    <script src="../../node_modules/wProto/staging/abase/component/Proto.s"></script>
    <script src="../../node_modules/winstancing/staging/abase/mixin/Instancing.s"></script>
    <script src="../../node_modules/wcloner/staging/abase/component/Cloner.s"></script>
    <script src="../../node_modules/wCopyable/staging/abase/mixin/Copyable.s"></script>
    <script src="../../node_modules/wConsequence/staging/abase/syn/Consequence.s"></script>
  </head>
  <body>
    <script>

      var con = new wConsequence();

      function heavyHandler()
      {
        var x = 0;
        for( var i = 0; i < 300000000; i++ )
        {
          if( x % 13 )
          x += i/13;
        }
        console.log( 'Done',x );
      }

      window.addEventListener( 'mousemove', function(e)
      {
        con.give( e );
        wTools.timeOut( 100, handle );
      });

      function handle()
      {
        con.got( function()
        {
          console.log( con.messagesGet().length );
          if( !con.messagesGet().length )
          heavyHandler();
        });
      }

    </script>
  </body>
</html>
